<div class="payment-container">
    <!-- Header and Form Section -->
    <h2>Payment Management</h2>
  
    <!-- Error Message Display -->
    <div *ngIf="errorMessage" class="alert alert-danger">
      {{ errorMessage }}
      <button (click)="errorMessage = null" class="close">&times;</button>
    </div>
  
    <!-- Loading Indicator -->
    <div *ngIf="isLoading" class="loading-overlay">
      <div class="spinner"></div>
    </div>
  
    <!-- Add Payment Form -->
    <form (ngSubmit)="addPayment()" class="payment-form">
      <div class="form-group">
        <label>Amount</label>
        <input type="number" [(ngModel)]="newPayment.amount" name="amount" 
               placeholder="Enter amount" class="form-control" required min="0.01" step="0.01">
      </div>
  
      <div class="form-group">
        <label>Payment Method</label>
        <select [(ngModel)]="newPayment.method" name="method" class="form-control" required>
          <option value="">Select method</option>
          <option value="Credit Card">Credit Card</option>
          <option value="Bank Transfer">Bank Transfer</option>
          <option value="PayPal">PayPal</option>
          <option value="Cash">Cash</option>
        </select>
      </div>
  
      <div class="form-group">
        <label>Status</label>
        <select [(ngModel)]="newPayment.status" name="status" class="form-control" required>
          <option value="pending">Pending</option>
          <option value="completed">Completed</option>
          <option value="failed">Failed</option>
        </select>
      </div>
  
      <div class="form-group">
        <label>Date</label>
        <input type="date" [(ngModel)]="newPayment.date" name="date" class="form-control" required>
      </div>
  
      <button type="submit" class="btn btn-primary" [disabled]="isLoading">
        {{ isLoading ? 'Processing...' : 'Add Payment' }}
      </button>
    </form>
  
    <!-- Payments Table -->
    <div class="table-responsive" *ngIf="payments.length > 0; else noPayments">
      <table class="table">
        <thead>
          <tr>
            <th>ID</th>
            <th>Amount</th>
            <th>Method</th>
            <th>Status</th>
            <th>Date</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let payment of payments">
            <td>{{ payment.id }}</td>
            <td>{{ payment.amount | currency }}</td>
            <td>{{ payment.method }}</td>
            <td>
              <span class="badge" [ngClass]="'bg-' + getStatusClass(payment.status)">
                {{ payment.status | titlecase }}
              </span>
            </td>
            <td>{{ payment.date | date:'mediumDate' }}</td>
            <td>
              <button (click)="selectPayment(payment)" class="btn btn-sm btn-warning me-2">
                Edit
              </button>
              <button (click)="deletePayment(payment.id)" class="btn btn-sm btn-danger">
                Delete
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  
    <!-- No Payments Message -->
    <ng-template #noPayments>
      <div class="alert alert-info">
        No payments found. Add your first payment above.
      </div>
    </ng-template>
  
    <!-- Edit Payment Section -->
    <div *ngIf="selectedPayment" class="edit-section">
      <h3>Edit Payment #{{ selectedPayment.id }}</h3>
      
      <div class="form-group">
        <label>Amount</label>
        <input type="number" [(ngModel)]="selectedPayment.amount" class="form-control">
      </div>
  
      <div class="form-group">
        <label>Method</label>
        <select [(ngModel)]="selectedPayment.method" class="form-control">
          <option value="Credit Card">Credit Card</option>
          <option value="Bank Transfer">Bank Transfer</option>
          <option value="PayPal">PayPal</option>
          <option value="Cash">Cash</option>
        </select>
      </div>
  
      <div class="form-group">
        <label>Status</label>
        <select [(ngModel)]="selectedPayment.status" class="form-control">
          <option value="pending">Pending</option>
          <option value="completed">Completed</option>
          <option value="failed">Failed</option>
        </select>
      </div>
  
      <div class="form-group">
        <label>Date</label>
        <input type="date" [(ngModel)]="selectedPayment.date" class="form-control">
      </div>
  
      <div class="button-group">
        <button (click)="updatePayment()" class="btn btn-success" [disabled]="isLoading">
          {{ isLoading ? 'Updating...' : 'Update' }}
        </button>
        <button (click)="selectedPayment = undefined" class="btn btn-secondary">
          Cancel
        </button>
      </div>
    </div>
  </div>